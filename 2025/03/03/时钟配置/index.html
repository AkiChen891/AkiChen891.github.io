<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="时钟来源和生成  包括以下三个时钟来源：  外部晶振，高速晶振频率24Mhz，低速晶振频率32.768KHz 低压差分信号 (LVDS) I&#x2F;O 端口，用于从外部获取时钟信号 锁相环(PLL)，主时钟包含七个 PLL。其中两个 PLL 分别配备四个相位小数分频器 (PFD)，以生成额外的频率。  七个PLL包括：  PLL1(ARM_PLL)，ARM内核时钟，最高可倍频至1.3GHz(但MCU最">
<meta property="og:type" content="article">
<meta property="og:title" content="I.MX6ULL 时钟配置">
<meta property="og:url" content="http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/index.html">
<meta property="og:site_name" content="Aki&#39;s Blog">
<meta property="og:description" content="时钟来源和生成  包括以下三个时钟来源：  外部晶振，高速晶振频率24Mhz，低速晶振频率32.768KHz 低压差分信号 (LVDS) I&#x2F;O 端口，用于从外部获取时钟信号 锁相环(PLL)，主时钟包含七个 PLL。其中两个 PLL 分别配备四个相位小数分频器 (PFD)，以生成额外的频率。  七个PLL包括：  PLL1(ARM_PLL)，ARM内核时钟，最高可倍频至1.3GHz(但MCU最">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/%E6%97%B6%E9%92%9F%E7%94%9F%E6%88%90%E6%9D%A5%E6%BA%90">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_2.png">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_3.png">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_4.png">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_5.png">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_6.png">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_7.png">
<meta property="og:image" content="http://akichen891.github.io/images/linux/clock_8.png">
<meta property="article:published_time" content="2025-03-03T06:52:08.000Z">
<meta property="article:modified_time" content="2025-03-04T04:50:14.472Z">
<meta property="article:author" content="Aki">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/%E6%97%B6%E9%92%9F%E7%94%9F%E6%88%90%E6%9D%A5%E6%BA%90">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon_mos.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>I.MX6ULL 时钟配置</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/_posts/">文章</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/AkiChen891">Github</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_51149752?spm=1000.2115.3001.5343">CSDN</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2025/03/04/IMX6ULL%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD%E9%85%8D%E7%BD%AE/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2025/03/02/Linux%E4%B8%8B%E8%A7%84%E8%8C%83%E6%80%A7Makefile%E8%A7%84%E5%88%99/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&text=I.MX6ULL 时钟配置"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&is_video=false&description=I.MX6ULL 时钟配置"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=I.MX6ULL 时钟配置&body=Check out this article: http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&name=I.MX6ULL 时钟配置&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&t=I.MX6ULL 时钟配置"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E6%9D%A5%E6%BA%90%E5%92%8C%E7%94%9F%E6%88%90"><span class="toc-number">1.</span> <span class="toc-text"> 时钟来源和生成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ccm%E6%97%B6%E9%92%9F%E6%A0%91"><span class="toc-number">2.</span> <span class="toc-text"> CCM时钟树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text"> 时钟配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text"> 代码</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        I.MX6ULL 时钟配置
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Aki</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-03-03T06:52:08.000Z" class="dt-published" itemprop="datePublished">2025-03-03</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="时钟来源和生成"><a class="markdownIt-Anchor" href="#时钟来源和生成"></a> 时钟来源和生成</h2>
<p><img src="%E6%97%B6%E9%92%9F%E7%94%9F%E6%88%90%E6%9D%A5%E6%BA%90" alt="/images/linux/clock_1.png"><br>
包括以下三个时钟来源：</p>
<ol>
<li>外部晶振，高速晶振频率24Mhz，低速晶振频率32.768KHz</li>
<li>低压差分信号 (LVDS) I/O 端口，用于从外部获取时钟信号</li>
<li>锁相环(PLL)，主时钟包含七个 PLL。其中两个 PLL 分别配备四个相位小数分频器 (PFD)，以生成额外的频率。</li>
</ol>
<p>七个PLL包括：</p>
<ul>
<li>PLL1(ARM_PLL)，ARM内核时钟，最高可倍频至1.3GHz(但MCU最高仅支持到1.0GHz)</li>
<li>PLL2(SYS_PLL/528_PLL)，固定倍频22倍，从外部高速晶振的24MHz倍频产生528MHz，自带四个PFD。通常528_PLL和4路PFD是MX6U内部系统总线的时钟源，如逻辑单元、DDR、NAND/NOR设备等</li>
<li>PLL3(USB1_PLL)，USB PHY的第一个实例（USBPHY1，也称为 OTG PHY）一起使用。此 PLL 驱动四个 PFD（PLL3_PFD0…PLL3_PFD3）并以固定乘数 20 运行。这导致 VCO 频率为 480 MHz，振荡器为 24 MHz。主 PLL 输出及其 PFD 输出用作许多需要恒定频率的时钟根的输入，例如 UART 和其他串行接口、音频接口等</li>
<li>PLL4(Audio_PLL)，用于生成具有标准音频频率的低抖动和高精度音频时钟。其频率范围为 650 MHz 至 1300 MHz，频率分辨率优于 1 Hz。该时钟主要用作串行音频接口的时钟和外部音频编解码器的参考时钟。</li>
<li>PLL5(Video_PLL)，用于生成具有标准视频频率的低抖动和高精度视频时钟。PLL 振荡器频率范围为 650 MHz 至 1300 MHz，频率分辨率优于 1 Hz。该时钟主要用作显示和视频接口的时钟。</li>
<li>PLL6(ENET_PLL)，固定(20+5/6)倍频，输出500MHz，用于生成以太网</li>
<li>PLL7(USB2_PLL)，专门为 USB2 PHY（USBPHY2，也称为 OTG PHY）提供时钟，固定倍频 20，输出频率480MHz</li>
</ul>
<h2 id="ccm时钟树"><a class="markdownIt-Anchor" href="#ccm时钟树"></a> CCM时钟树</h2>
<p><img src="/images/linux/clock_2.png" alt="时钟树(1)"></p>
<p><img src="/images/linux/clock_3.png" alt="时钟树(2)"></p>
<p>具体参见手册第629页。</p>
<h2 id="时钟配置"><a class="markdownIt-Anchor" href="#时钟配置"></a> 时钟配置</h2>
<p>以ARM时钟配置为例：</p>
<p><img src="/images/linux/clock_4.png" alt="ARM时钟"></p>
<p>时钟从PLL1的996MHz开始，通过寄存器CCM_CACRR的ARM_PODF位进行分频，可选1/2/4/8分频，然后得到ARM时钟ARM_CLK_ROOT。灰色的/2分频并未实际效果。其中PLL1频率可通过寄存器CCM_ANALOG_PLL_ARMn设置。</p>
<p><img src="/images/linux/clock_5.png" alt="CCM_CACRR寄存器"></p>
<p><img src="/images/linux/clock_6.png" alt="CCM_ANALOG_PLL_ARMn寄存器"></p>
<p>修改PLL1时钟时要首先要切换内核时钟源。</p>
<p><img src="/images/linux/clock_7.png" alt="PLL1时钟源"></p>
<ol>
<li>PLL1最终输出时钟频率。</li>
<li>选择器，用于选择pll1的时钟源，由CCM_CCSR的PLL1_SW_CLK_SEL位决定。默认为pll1_main_clk，但如果要调整pll1_main_clk频率，则首先应将pll_sw_clk切换至step_clk，调整完成后再切换回来。</li>
<li>选择器，用于选择step_clk的时钟源，由CCM_CCSR的STEP_SEL位决定。默认为osc_clk，即外部高速晶振。</li>
</ol>
<p><img src="/images/linux/clock_8.png" alt="CCM_CCSR寄存器"></p>
<p>至此，修改I.MX6U主频的步骤可以归纳为：</p>
<ol>
<li>设置CCM_CCSR的STEP_SEL位，设置step_clk时钟源为外部24MHz高速晶振</li>
<li>设置CCM_CCSR的PLL1_SW_CLK_SEL位，设置pll_sw_clk来源为step_clk=24Mhz</li>
<li>设置CCM_ANALOG_PLL_ARMn，将pll1_main_clk设置为1056MHz</li>
<li>设置CCM_CCSR的PLL1_SW_CLK_SEL位，将pll1_sw_clk时钟源切换回pll1_main_clk</li>
<li>设置CCM_CACRR的ARM_PODF为2分频，完成分频设置</li>
</ol>
<p>其他的时钟配置方式大同小异。</p>
<h2 id="代码"><a class="markdownIt-Anchor" href="#代码"></a> 代码</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * @description	: 初始化系统时钟，设置系统时钟为792Mhz，并且设置PLL2和PLL3各个</span><br><span class="line"> 				  PFD时钟,所有的时钟频率均按照I.MX6U官方手册推荐的值.</span><br><span class="line"> * @param 		: 无</span><br><span class="line"> * @return 		: 无</span><br><span class="line"> */</span><br><span class="line">void imx6u_clkinit(void)</span><br><span class="line">&#123;</span><br><span class="line">	unsigned int reg = 0;</span><br><span class="line">	/* 1、设置ARM内核时钟为792MHz */</span><br><span class="line">	/* 1.1、判断当前ARM内核是使用的那个时钟源启动的，正常情况下ARM内核是由pll1_sw_clk驱动的，而</span><br><span class="line">	 *      pll1_sw_clk有两个来源：pll1_main_clk和tep_clk。</span><br><span class="line">	 *      如果我们要让ARM内核跑到792M的话那必须选择pll1_main_clk作为pll1的时钟源。</span><br><span class="line">	 *      如果我们要修改pll1_main_clk时钟的话就必须先将pll1_sw_clk从pll1_main_clk切换到step_clk,</span><br><span class="line">	 *		当修改完pll1_main_clk以后在将pll1_sw_clk切换回pll1_main_clk。而step_clk的时钟源可以选择</span><br><span class="line">	 * 		板子上的24MHz晶振。</span><br><span class="line">	 */</span><br><span class="line">	</span><br><span class="line">	if((((CCM-&gt;CCSR) &gt;&gt; 2) &amp; 0x1 ) == 0) 	/* 当前pll1_sw_clk使用的pll1_main_clk*/</span><br><span class="line">	&#123;	</span><br><span class="line">		CCM-&gt;CCSR &amp;= ~(1 &lt;&lt; 8);				/* 配置step_clk时钟源为24MH OSC */	</span><br><span class="line">		CCM-&gt;CCSR |= (1 &lt;&lt; 2);				/* 配置pll1_sw_clk时钟源为step_clk */</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/* 1.2、设置pll1_main_clk为792MHz</span><br><span class="line">	 *      因为pll1_sw_clk进ARM内核的时候会被二分频！</span><br><span class="line">	 *      配置CCM_ANLOG-&gt;PLL_ARM寄存器</span><br><span class="line">	 *      bit13: 1 使能时钟输出</span><br><span class="line">	 *      bit[6:0]: 66, 由公式：Fout = Fin * div_select / 2.0，792=24*div_select/2.0,</span><br><span class="line">	 *              		得出：div_select=    66 </span><br><span class="line">	 */</span><br><span class="line">	CCM_ANALOG-&gt;PLL_ARM = (1 &lt;&lt; 13) | ((66 &lt;&lt; 0) &amp; 0X7F); 	/* 配置pll1_main_clk=792MHz */</span><br><span class="line">	CCM-&gt;CCSR &amp;= ~(1 &lt;&lt; 2);									/* 将pll_sw_clk时钟重新切换回pll1_main_clk */</span><br><span class="line">	CCM-&gt;CACRR = 0;											/* ARM内核时钟为pll1_sw_clk/1=792/1=792Mhz */</span><br><span class="line"></span><br><span class="line">	/* 2、设置PLL2(SYS PLL)各个PFD */</span><br><span class="line">	reg = CCM_ANALOG-&gt;PFD_528;</span><br><span class="line">	reg &amp;= ~(0X3F3F3F3F);		/* 清除原来的设置 						*/</span><br><span class="line">	reg |= 32&lt;&lt;24;				/* PLL2_PFD3=528*18/32=297Mhz 	*/</span><br><span class="line">	reg |= 24&lt;&lt;16;				/* PLL2_PFD2=528*18/24=396Mhz(DDR使用的时钟，最大400Mhz) */</span><br><span class="line">	reg |= 16&lt;&lt;8;				/* PLL2_PFD1=528*18/16=594Mhz 	*/</span><br><span class="line">	reg |= 27&lt;&lt;0;				/* PLL2_PFD0=528*18/27=352Mhz  	*/</span><br><span class="line">	CCM_ANALOG-&gt;PFD_528=reg;	/* 设置PLL2_PFD0~3 		 		*/</span><br><span class="line"></span><br><span class="line">	/* 3、设置PLL3(USB1)各个PFD */</span><br><span class="line">	reg = 0;					/* 清零   */</span><br><span class="line">	reg = CCM_ANALOG-&gt;PFD_480;</span><br><span class="line">	reg &amp;= ~(0X3F3F3F3F);		/* 清除原来的设置 							*/</span><br><span class="line">	reg |= 19&lt;&lt;24;				/* PLL3_PFD3=480*18/19=454.74Mhz 	*/</span><br><span class="line">	reg |= 17&lt;&lt;16;				/* PLL3_PFD2=480*18/17=508.24Mhz 	*/</span><br><span class="line">	reg |= 16&lt;&lt;8;				/* PLL3_PFD1=480*18/16=540Mhz		*/</span><br><span class="line">	reg |= 12&lt;&lt;0;				/* PLL3_PFD0=480*18/12=720Mhz	 	*/</span><br><span class="line">	CCM_ANALOG-&gt;PFD_480=reg;	/* 设置PLL3_PFD0~3 					*/	</span><br><span class="line"></span><br><span class="line">	/* 4、设置AHB时钟 最小6Mhz， 最大132Mhz (boot rom自动设置好了可以不用设置)*/</span><br><span class="line">	CCM-&gt;CBCMR &amp;= ~(3 &lt;&lt; 18); 	/* 清除设置*/ </span><br><span class="line">	CCM-&gt;CBCMR |= (1 &lt;&lt; 18);	/* pre_periph_clk=PLL2_PFD2=396MHz */</span><br><span class="line">	CCM-&gt;CBCDR &amp;= ~(1 &lt;&lt; 25);	/* periph_clk=pre_periph_clk=396MHz */</span><br><span class="line">	while(CCM-&gt;CDHIPR &amp; (1 &lt;&lt; 5));/* 等待握手完成 */</span><br><span class="line">		</span><br><span class="line">	/* 修改AHB_PODF位的时候需要先禁止AHB_CLK_ROOT的输出，但是</span><br><span class="line">	 * 我没有找到关闭AHB_CLK_ROOT输出的的寄存器，所以就没法设置。</span><br><span class="line">	 * 下面设置AHB_PODF的代码仅供学习参考不能直接拿来使用！！</span><br><span class="line">	 * 内部boot rom将AHB_PODF设置为了3分频，即使我们不设置AHB_PODF，</span><br><span class="line">	 * AHB_ROOT_CLK也依旧等于396/3=132Mhz。</span><br><span class="line">	 */</span><br><span class="line">#if 0</span><br><span class="line">	/* 要先关闭AHB_ROOT_CLK输出，否则时钟设置会出错 */</span><br><span class="line">	CCM-&gt;CBCDR &amp;= ~(7 &lt;&lt; 10);	/* CBCDR的AHB_PODF清零 */</span><br><span class="line">	CCM-&gt;CBCDR |= 2 &lt;&lt; 10;		/* AHB_PODF 3分频，AHB_CLK_ROOT=132MHz */</span><br><span class="line">	while(CCM-&gt;CDHIPR &amp; (1 &lt;&lt; 1));/</span><br><span class="line">* 等待握手完成 */</span><br><span class="line">#endif</span><br><span class="line">	</span><br><span class="line">	/* 5、设置IPG_CLK_ROOT最小3Mhz，最大66Mhz (boot rom自动设置好了可以不用设置)*/</span><br><span class="line">	CCM-&gt;CBCDR &amp;= ~(3 &lt;&lt; 8);	/* CBCDR的IPG_PODF清零 */</span><br><span class="line">	CCM-&gt;CBCDR |= 1 &lt;&lt; 8;		/* IPG_PODF 2分频，IPG_CLK_ROOT=66MHz */</span><br><span class="line">	</span><br><span class="line">	/* 6、设置PERCLK_CLK_ROOT时钟 */</span><br><span class="line">	CCM-&gt;CSCMR1 &amp;= ~(1 &lt;&lt; 6);	/* PERCLK_CLK_ROOT时钟源为IPG */</span><br><span class="line">	CCM-&gt;CSCMR1 &amp;= ~(7 &lt;&lt; 0);	/* PERCLK_PODF位清零，即1分频 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/_posts/">文章</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/AkiChen891">Github</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_51149752?spm=1000.2115.3001.5343">CSDN</a></li>
        
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E6%9D%A5%E6%BA%90%E5%92%8C%E7%94%9F%E6%88%90"><span class="toc-number">1.</span> <span class="toc-text"> 时钟来源和生成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ccm%E6%97%B6%E9%92%9F%E6%A0%91"><span class="toc-number">2.</span> <span class="toc-text"> CCM时钟树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text"> 时钟配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text"> 代码</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&text=I.MX6ULL 时钟配置"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&is_video=false&description=I.MX6ULL 时钟配置"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=I.MX6ULL 时钟配置&body=Check out this article: http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&title=I.MX6ULL 时钟配置"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&name=I.MX6ULL 时钟配置&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://akichen891.github.io/2025/03/03/%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE/&t=I.MX6ULL 时钟配置"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2025
    Aki
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/_posts/">文章</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/AkiChen891">Github</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_51149752?spm=1000.2115.3001.5343">CSDN</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
